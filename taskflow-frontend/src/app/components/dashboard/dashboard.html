<div class="dashboard-container">
  <!-- Header -->
  <header class="dashboard-header">
    <div class="header-content">
      <div class="header-info">
        <h1>TaskFlow Dashboard</h1>
        <p class="welcome-text">Welcome back, {{ user?.name }}! 👋</p>
      </div>
      <button class="logout-btn" (click)="logout()">Logout</button>
    </div>
  </header>

  <!-- Stats Cards -->
  <div class="stats-container">
    <div class="stat-card">
      <div class="stat-icon total">📋</div>
      <div class="stat-info">
        <h3>{{ tasks.length }}</h3>
        <p>Total Tasks</p>
      </div>
    </div>
    <div class="stat-card">
      <div class="stat-icon pending">⏳</div>
      <div class="stat-info">
        <h3>{{ pendingTasksCount }}</h3>
        <p>Pending</p>
      </div>
    </div>
    <div class="stat-card">
      <div class="stat-icon completed">✅</div>
      <div class="stat-info">
        <h3>{{ completedTasksCount }}</h3>
        <p>Completed</p>
      </div>
    </div>
  </div>

  <div class="dashboard-content">
    <!-- Task Form Section -->
    <section class="task-form-section">
      <div class="section-header">
        <h2>{{ editTaskId ? 'Edit Task' : 'Create New Task' }}</h2>
        <button *ngIf="editTaskId" class="cancel-btn" (click)="resetForm()">Cancel Edit</button>
      </div>
      
      <form [formGroup]="taskForm" (ngSubmit)="onSubmit()" class="task-form">
        <div class="form-group">
          <label for="title" class="form-label">Task Title</label>
          <input
            type="text"
            id="title"
            class="form-control"
            formControlName="title"
            placeholder="What needs to be done?"
            maxlength="100">
          <div *ngIf="taskForm.get('title')?.invalid && taskForm.get('title')?.touched" 
               class="validation-error">
            Title is required
          </div>
        </div>

        <div class="form-group">
          <label for="description" class="form-label">Description</label>
          <textarea
            id="description"
            class="form-control"
            formControlName="description"
            placeholder="Add some details..."
            rows="3"></textarea>
          <div *ngIf="taskForm.get('description')?.invalid && taskForm.get('description')?.touched" 
               class="validation-error">
            Description is required
          </div>
        </div>

        <button 
          type="submit" 
          class="submit-btn" 
          [disabled]="taskForm.invalid">
          {{ editTaskId ? 'Update Task' : 'Add Task' }}
        </button>
      </form>
    </section>

    <!-- Tasks List Section -->
    <section class="tasks-section">
      <div class="section-header">
        <h2>Your Tasks</h2>
        
        <!-- Filter Buttons -->
        <div class="filter-buttons">
          <button 
            class="filter-btn" 
            [class.active]="filterStatus === 'all'"
            (click)="onFilterChange('all')">
            All ({{ tasks.length }})
          </button>
          <button 
            class="filter-btn" 
            [class.active]="filterStatus === 'pending'"
            (click)="onFilterChange('pending')">
            Pending ({{ pendingTasksCount }})
          </button>
          <button 
            class="filter-btn" 
            [class.active]="filterStatus === 'completed'"
            (click)="onFilterChange('completed')">
            Completed ({{ completedTasksCount }})
          </button>
        </div>
      </div>

      <!-- Loading State -->
      <div *ngIf="isLoading" class="loading-state">
        <div class="loading-spinner"></div>
        <p>Loading your tasks...</p>
      </div>

      <!-- Empty State -->
      <div *ngIf="!isLoading && filteredTasks.length === 0" class="empty-state">
        <div class="empty-icon">📝</div>
        <h3>No tasks found</h3>
        <p>{{ filterStatus === 'all' ? 'Create your first task to get started!' : `No ${filterStatus} tasks found` }}</p>
      </div>

      <!-- Tasks List -->
      <div *ngIf="!isLoading && filteredTasks.length > 0" class="tasks-list">
        <div *ngFor="let task of filteredTasks" 
             class="task-card"
             [class.completed]="task.status === 'completed'">
          
          <!-- Task Status Toggle -->
          <div class="task-status">
            <button 
              class="status-toggle"
              [class.completed]="task.status === 'completed'"
              (click)="onToggleStatus(task)">
              {{ task.status === 'completed' ? '✅' : '⭕' }}
            </button>
          </div>

          <!-- Task Content -->
          <div class="task-content">
            <h4 class="task-title">{{ task.title }}</h4>
            <p class="task-description">{{ task.description }}</p>
            <div class="task-meta">
              <span class="task-date">
                Created: {{ task.createdAt | date:'medium' }}
              </span>
              <button 
        class="task-status-btn"
       [class.completed]="task.status === 'completed'"
       (click)="onToggleStatus(task)"
        title="Click to change status">
        {{ task.status === 'completed' ? '✅ Completed' : '⏳ Pending' }}
</button>
            </div>
          </div>

          <!-- Task Actions -->
          <div class="task-actions">
            <button 
              class="action-btn edit-btn"
              (click)="onEdit(task)"
              title="Edit task">
              ✏️
            </button>
            <button 
              class="action-btn delete-btn"
              (click)="onDelete(task._id!)"
              title="Delete task">
              🗑️
            </button>
          </div>
        </div>
      </div>
    </section>
  </div>
</div>